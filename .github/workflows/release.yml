name: Release Zip

on:
  workflow_dispatch:
    inputs:
      tag:
        description: "Tag name to release (e.g., v1.0.0)"
        required: true

permissions:
  contents: write

jobs:
  release:
    runs-on: ubuntu-latest
    env:
      TAG_NAME: ${{ github.event_name == 'workflow_dispatch' && github.event.inputs.tag || github.ref_name }}
    steps:
      - name: Check out code
        uses: actions/checkout@v4

      - name: Create zip archive with top-level folder
        run: |
          echo "=== Current directory ==="
          pwd
          echo "=== Listing files ==="
          ls -la
          echo "=== Creating xmlui-weather folder ==="
          mkdir -p xmlui-weather
          echo "=== Copying files ==="
          cp -v -r Main.xmlui components index.html README.md xmlui-weather/
          echo "=== Contents of xmlui-weather ==="
          ls -la xmlui-weather/
          echo "=== Creating zip ==="
          zip -r xmlui-weather.zip xmlui-weather
          echo "=== Zip created ==="
          ls -lh xmlui-weather.zip

      - name: Publish release assets
        uses: softprops/action-gh-release@v1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          tag_name: ${{ env.TAG_NAME }}
          target_commitish: ${{ github.sha }}
          files: xmlui-weather.zip
          body: |
            You can run it [online](https://playground.xmlui.org/#/playground/#H4sIAAAAAAAAE80Y227bNvRXTok0blHfUrTA5lopMrdpBjRbUXfJQxUUtHRicZZIgaRsp4b%2Bqd%2FQLxuou2Q5drY87E06PPc7uSFKU%2B5SX3Akow2hYUhGZHwWhjYHWFLZd5i%2Bs2wypVxT%2BCwU7cLkzCb5sUIqHW9yPxJKKeQlKkXnaNmkPNAYhH9xpi2bnJdQR3CXaSa4ZZMNrJBqD%2BU7qml%2FSf0I%2B04kJXL9rcD7OryBuKTnSCUq%2FY1KpDtYVFEa1FRpKbgI7naQZpCvw5sStcFC4jzXvioog8PxcRvY8Nh5kspOZZza3AgaG52mIpIOml8A5lo2qeib6gMQSd%2Byiad1qEaDwUpr2Wd8sCkjF7%2B9FTKg2vr7JKdJIvaH0OyWOdS4uBk9AMHfGyTLJs8S7OdgncIGqrEGCzoTEfkucKHhlnE39ye4VFO4FRI68AJKVeAFdPrwyUeqEBwPnQVoD8EkIXAaYL%2FzxjgBBrkTrqaaOgvwhGTfBdfUP%2FPZnAfITU45yDVKm8CKudqzbHIyHD61SUYLML44hPo0RTboJ8X3dWbHO6q8maDSzTgOCpzxIOXelJZzWKLUzGkXmePcr1iOtZI0nAiu01MtI6ycNS3PTanp0sQr4YdpcJg17ZqelsfjL7jWv4l1Ccmy2sT%2Fdx5GusoMADmd%2BWgQNk%2Bqhcr4JynmEpWK6wShTx30hO%2Biydv3Rr1KbvX7dWzGmWbUvzKlZ2QYzAbDgPHrwnMSg%2FrpaveR4O%2BYO%2FEoT2rq2ZL6Wf0k6liwpH6Z6YV%2Ffou0FvxAET6doan8D6jzdN3pPiO1ryULnj3v%2B8jn2oNTGMZNnSc%2BcxZG30zZSuFaieZvtuq%2FUzeiUhW1TDy0BgHGn6nLxAcpovC%2BYOWjZcuGHX7P8Su%2BP60Sjht6Z9A%2FQ9MdC1%2F%2F%2FHFuE1hmSpw34tdOMalQTLYothxmQKULdjl2u%2FuY2oKVh8lcqkYpTuRLRhOPu6i0jBzNltXabBBkIgzLUsBVraXkkvbW5aHNdxoyzlFWcykxqVRdodkIqLyrhe6joC7j89rkMaVe%2BC2zIv25anhtv1G%2BoC66ZnRv7QoG%2BKRWEMfHWYFbVqV44l39OocGdJ23mVcva4V%2BWH%2BeUWcxlyLi7kT4ycw%2BcsxHrzzo1b1XuOewATunoWWTYb1QL17WMrm6cVSTuYaWxnQmkS4uhWtKYiWkW8vQ9jADbCDbr97mHy%2Bg04UOjEwX2tQWK0dEXMu7YrOqKVRJiJaUaBmehw2%2FQ0fpviGZNcz7hNY7SOLSW8H1lH03Hn2VZFACuUY29wzlTPhugw5gUzZFy6xyHXgLxdKdLO%2FfJjBqgs7jnz%2FqHazm0FaV0qQ%2BIMgVpeKHCjnKv3trv2m%2FwoC1%2B6C0Lq9vVE5b4rQo0da8dzetdl39eUOnc0Rfgc8WuCdACeJHtsB6kAqwCVSbN7cq4GJHBTxs7d6b2NmSMtVUt604v%2B7ccCa%2BiFyYiGVzw1kWq1thvWNwHYMaP22uV%2F9agYsoYC7Td3ulexniI8q%2BNteqaYjo7pW%2BYtxVBvOS%2BahiCELv0dT4ZMZ6JHGvEmGGGEMw27Ua%2Fk%2FzbBpxydQuE4vXgL5K8bbW9%2F8iWKE%2BRK5C%2FXhiL4U4zOAgQ3xc0YeYHKR4Oy8Zu%2FY60%2BGaW92T9rVu%2F9WytZs%2FcL9NL6O0vI6CFqAQIXvtKvbXopJUyxpeM3Q8OAvD5It0iSOCUHDkWpHRVzKe5L%2BJLNNGKpFKtartvumCd6RC6mCveCaqXH9%2FqYTyIJMfPAhVYJPTzVEoRaj6SZ7E9eW9mPdtUz0nTKd2hbDisvGgcEviNpuTG%2BM5fsvm5nVUexig8d%2BGMJeMyDrwI0a6RKJK3uEUGW1iQ%2BALSUb5jh1KFlB513s9HJJuyuOKSoNLjLI9xb4jGZGT1%2BGadMlMrKcedcWqlzx4GDYlSAUk7hIteCKK%2BMbMQrGcaWPZ710Kl%2FrvGPXFnIzIymMajZwGVvLYhm6vvFqmF9VtO14NhySOu8SlcrElPEVN7jwlpWuu2zIjjOMbQy0S7qkX2BrdL4YLGd1SX2GXqBUNQ3SL%2F1DikuHKXAkKmJAMuaaZkmXOkS6hyf01Y1mEKYMmT92Z75LomkFBRsnbdxz%2FA3CJhEYSFwAA).

            To run locally:
            - Install the [XMLUI CLI](https://github.com/xmlui-org/xmlui-cli/releases)
            - `xmlui run https://github.com/xmlui-org/xmlui-weather/releases/latest/download/xmlui-weather.zip`
